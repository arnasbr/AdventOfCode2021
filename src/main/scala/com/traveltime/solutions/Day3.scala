package com.traveltime.solutions

import scala.annotation.tailrec
import scala.util.Try

object Day3 {
  def part1(data: List[String]): Long = {
    def binaryToDecimal(binary: List[Int]): Long = {
      binary.reverse.zipWithIndex.map { case (digit, index) =>
        digit * math.pow(2, index).toInt
      }.sum
    }

    val transposedData = data.transpose
    val sumsOfOnes = transposedData.map(x => x.count(_ == '1'))
    val sumsOfZeroes = transposedData.map(x => x.count(_ == '0'))

    val zippedList = sumsOfOnes zip sumsOfZeroes
    val gamma = zippedList.map { case (a, b) => if (a > b) 1 else 0 }
    val epsilon = zippedList.map { case (a, b) => if (a <= b) 1 else 0 }

    binaryToDecimal(gamma) * binaryToDecimal(epsilon)
  }

  @tailrec
  def part2Oxygen(
      data: List[String],
      index: Int = 0
  ): String = {
    if (data.length == 1) return data.headOption.getOrElse("")

    val transposedData = data.transpose
    val column = Try(transposedData(index)).toOption
    column match {
      case Some(chars) =>
        val sumOfOnes =
          chars.map(x => x == '1').count(_ == true)
        val sumOfZeroes =
          chars.map(x => x == '0').count(_ == true)
        val moreCommon = if (sumOfOnes >= sumOfZeroes) '1' else '0'

        val filteredOxygen = data.filter(_(index) == moreCommon)
        //filteredOxygen
        part2Oxygen(filteredOxygen, index + 1)

      case None => ""
    }
  }

  @tailrec
  def part2CO2(
      data: List[String],
      index: Int = 0
  ): String = {
    if (data.length == 1) return data.headOption match {
      case Some(value) => value
      case None        => ""
    }

    val transposedData = data.transpose
    val column = Try(transposedData(index)).toOption
    column match {
      case Some(chars) =>
        val sumOfOnes = chars.map(x => x == '1').count(_ == true)
        val sumOfZeroes = chars.map(x => x == '0').count(_ == true)
        val lessCommon =
          if (sumOfZeroes <= sumOfOnes) '0'
          else '1'

        val filteredCo2 = data.filter(_(index) == lessCommon)
        //filteredOxygen
        part2CO2(filteredCo2, index + 1)
      case None => ""
    }
  }

  def main(args: Array[String]): Unit = {
    val input =
      "00100\n11110\n10110\n10111\n10101\n01111\n00111\n11100\n10000\n11001\n00010\n01010"
    //val input =
    "110001010110\n011101111101\n111011110101\n011110101000\n100100011001\n011001001110\n101011000101\n110000111111\n110110101000\n010101101000\n001101001101\n111000001011\n111000011010\n001111001000\n100110001111\n111100110100\n100000010101\n001110100000\n100111110110\n100110000110\n111100101101\n100101010100\n011100010011\n111010110000\n110100011110\n111010101100\n111001001101\n110001110100\n100110111011\n101111111011\n011100111000\n010011110010\n111001011011\n110100111000\n111000011001\n010100000000\n100000101111\n010100110010\n110001101000\n000101101001\n001111101010\n100100000001\n101000111011\n101110001111\n000100011000\n100110101110\n111011101010\n010110001101\n110100001111\n011110101100\n101000011100\n111101111101\n110101010100\n101100111111\n111110110101\n011011110111\n101101000111\n111101000011\n001011110110\n110011110111\n000011101111\n100001101010\n111011101101\n010110111000\n110101111100\n110010101000\n001011001010\n000110101001\n000001000011\n111100001010\n100110111010\n111011111000\n011111101111\n000010100111\n111011011111\n011101110010\n000000100111\n100111000100\n000010010111\n101111101011\n011111000101\n011100100101\n011000111101\n011110001010\n100110101011\n011011010011\n011100000101\n011110000100\n000110110010\n001101101110\n110011000001\n110100111110\n110011000101\n000101011110\n001010000000\n000011000010\n110010111110\n011111110110\n100000110000\n011101111000\n100011100101\n101000000101\n001111010011\n010110110011\n000100100100\n001010001001\n010011100100\n110101110011\n001001000001\n101110110010\n001001000110\n010010100000\n000111101011\n010010001000\n011111000111\n010011010001\n110101101101\n000110010101\n111011110100\n010000110101\n110110101111\n010110111101\n100000010000\n001010011111\n111001001111\n011110110111\n101011000111\n010100011110\n111100100011\n110100110110\n001000011000\n011011111101\n111111110010\n000011110010\n110101111101\n001011111101\n000010011000\n001111101101\n100010010101\n111101110001\n011010110101\n011000000110\n111110100011\n000010111001\n101001111100\n001011011010\n100110111110\n000111001010\n001011101110\n100010110110\n001100110000\n000110001010\n100010001000\n111110011110\n110011111000\n100011101110\n001110100101\n010110110000\n101110101010\n110111010111\n110011000100\n100110101100\n101110100110\n010101011101\n100111100010\n010110110010\n000111100001\n101001101001\n011101110101\n011111100111\n000101010011\n110111100010\n011110000000\n011101110110\n110100110100\n111110111001\n000100000011\n011110111011\n011010100111\n111100110111\n100010011101\n011001001111\n001010101100\n010110111010\n111000110010\n011011100111\n101111000010\n110011011100\n110110011110\n000101011100\n100100110000\n110000100011\n011001101001\n110000100010\n001000000011\n010110001100\n111111000001\n101111011100\n100100100101\n101010100110\n011110000001\n010100110110\n010111011000\n011110100010\n101000110010\n110001011011\n111110011111\n111100100110\n111110101000\n010001111101\n111000101111\n111001010110\n101000001111\n000100101001\n011101011001\n111101111100\n010001100100\n010111011100\n100101010110\n001010110010\n010010111110\n101110011100\n111100101010\n001001111111\n011101010000\n111011111101\n011000001110\n111100110010\n001001111101\n011100001110\n001001001000\n110011101111\n010001011110\n001100100100\n011100110000\n111100001110\n111110110000\n000011000011\n011000000011\n110010111111\n011110001011\n101110100010\n100100111000\n111101011010\n000111110101\n010100001001\n110010101101\n001101011111\n000101100101\n110011101100\n110111111111\n111000011000\n010000100100\n110101101011\n101010101001\n100111001101\n111011000001\n101101111010\n111001111001\n001001110100\n000111110000\n010111010110\n100011010111\n111011011101\n100010100001\n000111001110\n111100010001\n101001101101\n111101100111\n100110100010\n000010100101\n010010110111\n101100000101\n111011010110\n101101101101\n001110110111\n110011011111\n011111111001\n100100001100\n101010011101\n100000110110\n110101010000\n110110110111\n101001110110\n100001000101\n110100001001\n000111000100\n101000101001\n111111001100\n101011000100\n111000010100\n100111000110\n111011010100\n101101011101\n010000101101\n000110110110\n001110000101\n001010001000\n100111101111\n001011101001\n001100111101\n110111011111\n111010011010\n001110101111\n101000001110\n101001110001\n110111010010\n011111100101\n110001001001\n010010111010\n000001001010\n011000001100\n100000111011\n111000010101\n001110011001\n010001001100\n001100010101\n001011011000\n001101100100\n011001111111\n010010001011\n100010011111\n100011000100\n000110011110\n010010000000\n110110011001\n111000111010\n111010000111\n111011110110\n101101100111\n111100101001\n110001101110\n111101100001\n011111110111\n110110101001\n000111010101\n101011111111\n100110001000\n101000100000\n110101110010\n010100011011\n000000100101\n000000011110\n101011110000\n101001100001\n111010101101\n000011011100\n000000100010\n001011100000\n001110111111\n110100111001\n010110110111\n010111111010\n110100011010\n000101011111\n001000011100\n010011001011\n111011001100\n101111001101\n100010000001\n011000001010\n101010000011\n110110010100\n101001011101\n100001010001\n110011010101\n000001100000\n100101000101\n110110100110\n110001111010\n111011101011\n010010111101\n000110100101\n011110101110\n000101110001\n111111101100\n011100110010\n100011111010\n010011111101\n101000010101\n011000101000\n011111001111\n111001111010\n100000000100\n010000101001\n110000001000\n100100001101\n011001111010\n110111110111\n000011100111\n001100110001\n000111010001\n101110011110\n110010000010\n101100001101\n001000001100\n101110011001\n111000000110\n000111111100\n001110001110\n100011110100\n001011101100\n011010010010\n101000011111\n110001011010\n011001000000\n010011110001\n100001111011\n011011001111\n110100010011\n010111010001\n010101011011\n100000001100\n100111101010\n100010100000\n110000110001\n010000010101\n010101000010\n010100101100\n110101000001\n100010010110\n110011101011\n010101011001\n010001000011\n000011111110\n111110011101\n011010010000\n011011111100\n110010110011\n001101111011\n000011111101\n110000010110\n111011011011\n111110000000\n101100111010\n100110011111\n110111011001\n110110010010\n010010011110\n010110010101\n101110000000\n011001110110\n100110100011\n111101111010\n110101010011\n111110100010\n100110001100\n010010100010\n101010100001\n000000000101\n111001011100\n100100111110\n000000011010\n110011111101\n010100000011\n100001111111\n110001011001\n111111100011\n111101110000\n100011001101\n110001010100\n100110000111\n111110110110\n001011000011\n111111000000\n101011101101\n110001111011\n011111001000\n000001011101\n001101000011\n001000010000\n000011001110\n011001101000\n110101100101\n001111110111\n111110111101\n000011000111\n001010011100\n110010010011\n110001110111\n111010010011\n100010001110\n110000101000\n011001011000\n011100100000\n001000011001\n101011110011\n001010011110\n110100000101\n010011011110\n011001100001\n011110011010\n100110000000\n010110010100\n000100111110\n110101110101\n000110111100\n010000000111\n111101010100\n111011011100\n000010000011\n001100100001\n110010110001\n010010000010\n001000010110\n011001000001\n010100101110\n011100010100\n100000011010\n010111100000\n010111011001\n011100101001\n101110101011\n110010011001\n111110001110\n011100011100\n110000101010\n000010100010\n100101101110\n100010111010\n110101100001\n101111000100\n101000111001\n011111101101\n111100111110\n011001001000\n110100110010\n000011010101\n111010111011\n010010011000\n100101000100\n111010100100\n000111001101\n010001011000\n111101101100\n111110001111\n110100011011\n111100010101\n111001111100\n011100111011\n011011101111\n011001000011\n011100111101\n010100100010\n110101010110\n101100001000\n001100101001\n000001001111\n000110010100\n111101101010\n100111000111\n001011000111\n001011111011\n110101011100\n110000110101\n010001000110\n011100101111\n101110010001\n001011001000\n100100110010\n000011111000\n010010010000\n001011100010\n000000110011\n000101011010\n101111110000\n100001010100\n101110110110\n001100000101\n110111001101\n010001010011\n101011001111\n111111111110\n110011010011\n011101000101\n100001101000\n011001101100\n011100010000\n001111111000\n010110011111\n111101110100\n100011011101\n100010110011\n110111011000\n100110010101\n001001000000\n101000100110\n011010011010\n000000000110\n010011001010\n110000110010\n100001011010\n101111001001\n100010101001\n110111111100\n000010111110\n000110101111\n011101001011\n101110011010\n111101010101\n001101100110\n111100001101\n000011100000\n100111010110\n110100100111\n100011100110\n100001011110\n001110110011\n101011010011\n001100001000\n111011001110\n110011100000\n101000011001\n011100100001\n000110001011\n001001001001\n000011011101\n000010111010\n011001100111\n101001011011\n010001101101\n101110001011\n000001011110\n011100110001\n110011111011\n001101010011\n000101000110\n110101000000\n110000101111\n000110110111\n110100101100\n111011110000\n011110011101\n001101000001\n011010001010\n101000111010\n111101111000\n000010000000\n000010001010\n110000100110\n110010100111\n110000001100\n100010000100\n110010100101\n111011101001\n100011110000\n010110110110\n111100011011\n110001101111\n110010101111\n001001001010\n100100000011\n110100100011\n101010110001\n001001011111\n101101110110\n001111010101\n110000010011\n010110001110\n011011011100\n000000110100\n100101110001\n011011001100\n100101000001\n100101101101\n101010001110\n110101100110\n111010111101\n111001000101\n010101111100\n000110000000\n001010111010\n110110000001\n100000101110\n111011110010\n000111000101\n011001110010\n000100101010\n101001010010\n010001100001\n000101100000\n111000101110\n000100010010\n110110000011\n010101001010\n110101101110\n101111101000\n110011100101\n111110110011\n000100010011\n110110010001\n111100000010\n011011111011\n101101101001\n101011011001\n011011011111\n101100110001\n011011100010\n011101010101\n011101110100\n010000101011\n010110011011\n111001101001\n010010010010\n010111000010\n100001101100\n000000101110\n000000110101\n111001000100\n110111001110\n111100111001\n110101010010\n111100011000\n100110100100\n000100000000\n110111101011\n001011110111\n010101101011\n101110001100\n111111101010\n111100010110\n101000110011\n110100010000\n010010001100\n011101111100\n000011110001\n011010101010\n110001101010\n101001000011\n100010000110\n110100111101\n000011110110\n001010100110\n010111010101\n101011100111\n000101001000\n110010001000\n001100000100\n010000111100\n111011111111\n100101001010\n110011100111\n100011100000\n101010011111\n010111100101\n110110110101\n010111010000\n110011001110\n101100111101\n000001100001\n111010100001\n010000010110\n001001000101\n101011110001\n000101101110\n011110000010\n110011110100\n100001000001\n100000011110\n001101100101\n101111101101\n110010010100\n010111101110\n010101110111\n101010101000\n000100000010\n111000001010\n101100001100\n101010000001\n101001101011\n110110000000\n101100101101\n101010110011\n011000001001\n101010111010\n000001001100\n101001000010\n110000001111\n110101001101\n110011111111\n010110101111\n001101110110\n111010001010\n001010100010\n000101101011\n001100010111\n101111100111\n010100000101\n110111110000\n000110111011\n110000011000\n100101010000\n101010111100\n100101000111\n001110100111\n001000111011\n011010010100\n111110010010\n010101010000\n101100010110\n000011001100\n010010101011\n011011000100\n011100111100\n111010111010\n101111010000\n101011010000\n001010100111\n010100111100\n011001000010\n011110110100\n111000001001\n110010110010\n101011111001\n110001111001\n101001000100\n010100100011\n000110110101\n001000100010\n100110110010\n000100010001\n010100010010\n001011000000\n110101011000\n001001101011\n000111101110\n000100110000\n010000010100\n001011011011\n100000001110\n111010110100\n111001101011\n101110110011\n111010111111\n010101010100\n001110111110\n111010110110\n001101001011\n010111101011\n000110100011\n100001010000\n011111001010\n011001001001\n101100001001\n001100111011\n001001110111\n101110110000\n010011010100\n001100001111\n001111100001\n010100010011\n001001000010\n100101001100\n001010001101\n011011001001\n101110110001\n010001110100\n101101011001\n010001111001\n011101001000\n010011100011\n001000111010\n111110100101\n110000010001\n110100000000\n101011101110\n011101001111\n111110001101\n101100010000\n010100010101\n000010001000\n111111010110\n000100010100\n110100010101\n110010000110\n001111010111\n000100101100\n001111100111\n011110001101\n000111001111\n000001000110\n101100100000\n110100010100\n001011010000\n101011100110\n010000101010\n101001000101\n011000010110\n010111110100\n110010001001\n001111010000\n010010100111\n011001010001\n100010100010\n011111010101\n011100000010\n110101110000\n001010110100\n101110111110\n000010110100\n101100000100\n111010110111\n001001101010\n111010010110\n011011001010\n100001010111\n110010011101\n010110100001\n110000111101\n011001110111\n111110001010\n000101101010\n010011101101\n110111010001\n111011011010\n001111111010\n100111001111\n010111111111\n010000010000\n001111110011\n100110100000\n000100101111\n001000010010\n110001010001\n001011100111\n101111111111\n100101101001\n000010011001\n011011001101\n010110100000\n101001101100\n010010001111\n110111001001\n101011001000\n001001010010\n011011001000\n001110010110\n011011101011\n100111111101\n110001001111\n001110101001\n101101111011\n101011011101\n100100011111\n100001001111\n101000001010\n000010011010\n010110010010\n100101110100\n010100010100\n110111001111\n100000101001\n010110101100\n011101010011\n000111000011\n000000101010\n101001110010\n010101001000\n111100000001\n100101000010\n010011011010\n011111110011\n011111010011\n110001000101\n100010101011\n111010011101\n010110010110\n110011101000\n101001000000\n000000011100\n010011100000\n101010111000\n000101110101\n100111111110\n010100100110\n110110110100\n110001001011\n100010111101\n111111111101\n111111110101\n000110100110\n001100110011\n000011100101\n111000110011\n111010100010\n101010011001\n001110011010\n010100000100\n010010000011\n101000000001\n000011110000\n010011011100\n111000110001\n010111101111\n101100010010\n101110111111\n111101100101\n001100101011\n100110111100\n011100011010"

    val lines = input.split("\n").toList

    println(Day3.part2Oxygen(lines))
    println(Day3.part2CO2(lines))
  }
}
